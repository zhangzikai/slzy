/*
 * File: app/view/MyViewport1.js
 *
 * This file was generated by Sencha Architect version 3.0.4.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 4.2.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 4.2.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext
		.define(
				'MyApp.view.MyViewport',
				{
					extend : 'Ext.container.Viewport',
					alias : 'widget.ViewportWidget',

					requires : [ 'Ext.tab.Panel', 'Ext.tab.Tab', 'Ext.toolbar.Toolbar', 'Ext.menu.Menu', 'Ext.menu.Item', 'Ext.toolbar.Fill', 'Ext.container.ButtonGroup', 'Ext.form.field.ComboBox',
							'Ext.form.Label', 'Ext.container.Container', 'Ext.button.Button' ],

					layout : 'border',

					initComponent : function() {
						var me = this;
						Ext
								.applyIf(
										me,
										{
											items : [
													{
														xtype : 'panel',
														region : 'north',
														id : 'north',
														layout : {
															type : 'hbox',
															align : 'stretch'
														},
														height : 80,
														bodyStyle : 'background:#117DCF;',
														items : [ {
															xtype : 'image',
															width : 600,
															margin : '0px 20px 0px 10px',
															bodyStyle : 'background:#117DCF;margin-top:20px',
															src : 'images/header/title2.png'
														}, {
															xtype : 'panel',
															bodyStyle : 'background:#117DCF;',
															border : false,
															flex : 1
														}, {
															border : false,
															html : '<div class="splitLine"> </div>',
															width : 1
														},
														// {
														// xtype:
														// 'button',
														// iconCls:
														// 'layerControl',
														// text: '图层控制',
														// scale:
														// 'large',
														// iconAlign:
														// 'top',
														// border :
														// false,
														// style: {
														// background:'#117DCE'
														// },
														// width:120,
														// },
														{
															border : false,
															html : '<div class="splitLine"> </div>',
															hidden : !hasPermisson(110),
															width : 1
														}, {
															xtype : 'button',
															iconCls : 'dataQuery',
															text : '数据查询',
															scale : 'large',
															iconAlign : 'top',
															hidden : !hasPermisson(110),
															border : false,
															width : 120,
															style : {
																background : '#117DCF'
															},
															menu : [ {
																xtype : 'menuitem',
																text : '小班查询',
																hidden : !hasPermisson(11),
																name : 'xbquery',
																handler : function() {
																	var tab = Ext.ComponentQuery.query('panel[name="tabMenu"]')[0];
																	var container = Ext.ComponentQuery.query('panel[name="menuPanel"]')[0];
																	if (!container) {
																		tab.add({
																			xtype : 'panel',
																			width : 176,
																			title : '功能列表',
																			layout : 'fit',
																			name : 'menuPanel',
																		});
																		container = Ext.ComponentQuery.query('panel[name="menuPanel"]')[0];
																	}
																	;
																	tab.setActiveTab(1);
																	container.removeAll();
																	container.setTitle('小班查询');
																	var panel = Ext.widget('xbQueryWidget');
																	type = "xbquery";
																	container.add(panel);
																	var me = panel.down('treepicker');
																	var record = Ext.getCmp('westTree').getSelectionModel().getSelection()[0];
																	if (record == undefined)
																		return;
																	me.displayTplData = [ record.data ];
																	me.setValue(record.get('value'));
																	me.setRawValue(record.get('text'));
																}
															},
															// {
															// xtype:
															// 'menuitem',
															// text:
															// '林带查询',
															// hidden:!hasPermisson(12),
															// name:'ldquery',
															// handler:function(){
															// var
															// tab
															// =
															// Ext.ComponentQuery.query('panel[name="tabMenu"]')[0];
															// var
															// container
															// =
															// Ext.ComponentQuery.query('panel[name="menuPanel"]')[0];
															// if(!container){
															// tab.add({
															// xtype
															// :
															// 'panel',
															// width
															// :
															// 176,
															// title:'功能列表',
															// layout
															// :
															// 'fit',
															// name:'menuPanel',
															// } );
															// container
															// =
															// Ext.ComponentQuery.query('panel[name="menuPanel"]')[0];
															// };
															// tab.setActiveTab(1);
															// container.removeAll();
															// container.setTitle('林带查询');
															// var
															// panel
															// =
															// Ext.widget('xbQueryWidget');
															// container.add(panel);
															// var
															// me =
															// panel.down('treepicker');
															// var
															// record
															// =
															// Ext.getCmp('westTree').getSelectionModel().getSelection()[0];
															// if(record
															// ==
															// undefined)
															// return;
															// me.displayTplData
															// =
															// [record.data];
															// me.setValue(record.get('value'));
															// me.setRawValue(record.get('text'));
															// }
															// },
															{
																xtype : 'menuitem',
																text : '条件查询',
																hidden : !hasPermisson(13),
																name : 'tjquery',
																handler : function() {
																	var tab = Ext.ComponentQuery.query('panel[name="tabMenu"]')[0];
																	var container = Ext.ComponentQuery.query('panel[name="menuPanel"]')[0];
																	if (!container) {
																		tab.add({
																			xtype : 'panel',
																			width : 176,
																			title : '功能列表',
																			layout : 'fit',
																			name : 'menuPanel',
																		});
																		container = Ext.ComponentQuery.query('panel[name="menuPanel"]')[0];
																	}
																	;
																	tab.setActiveTab(1);
																	container.removeAll();
																	container.setTitle('条件查询');
																	var panel = Ext.widget('xbCondQueryWidget');
																	container.add(panel);
																	var me = panel.down('treepicker');
																	var record = Ext.getCmp('westTree').getSelectionModel().getSelection()[0];
																	if (record == undefined)
																		return;
																	me.displayTplData = [ record.data ];
																	me.setValue(record.get('value'));
																	me.setRawValue(record.get('text'));
																}
															} ]
														}, {
															border : false,
															name : 'split2d',
															hidden : !hasPermisson(210),
															html : '<div class="splitLine"> </div>',
															width : 1
														}, {
															xtype : 'button',
															iconCls : 'mapTools',
															text : '地图工具',
															hidden : !hasPermisson(210),
															scale : 'large',
															name : 'mapTools2d',
															hidden : true,
															iconAlign : 'top',
															border : false,
															style : {
																background : '#117DCF'
															},
															width : 120,
															menu : [ {
																xtype : 'menuitem',
																text : '切换为双屏',
																hidden : !hasPermisson(21),
																handler : function(item, e, eOpts) {
																	var tabPanel = Ext.ComponentQuery.query('ViewportWidget panel[name="tab2d"]')[0];
																	tabPanel.doLayout();
																	var tabPanel = Ext.ComponentQuery.query('ViewportWidget panel[name="tab2d"]')[0];
																	var width = tabPanel.getWidth() / 2;
																	var panel = Ext.ComponentQuery.query('ViewportWidget panel[name="map2d1"]')[0];
																	// if(panel.flex==1){
																	if (isDoubleScreen) {
																		isDoubleScreen = false;
																		// panel.flex
																		// =
																		// 0.1;
																		// panel.width=1;
																		panel.width = 5;
																		item.setText('切换为双屏');
																	} else {
																		isDoubleScreen = true;
																		// panel.flex
																		// = 1;
																		panel.width = width;
																		item.setText('切换为单屏');
																	}
																	tabPanel.doLayout();
																	// var
																	// x =
																	// config.mapCenter.x+0.01;
																	// var
																	// y =
																	// config.mapCenter.y;
																	// map.panTo(new
																	// OpenLayers.LonLat(x,
																	// y));
																	// map.panTo(new
																	// OpenLayers.LonLat(x-0.01,
																	// y));

																}
															}, {
																xtype : 'menuitem',
																hidden : !hasPermisson(22),
																text : '小班对比',
																handler : function() {

																	var tab = Ext.ComponentQuery.query('panel[name="tabMenu"]')[0];
																	var container = Ext.ComponentQuery.query('panel[name="menuPanel"]')[0];
																	if (!container) {
																		tab.add({
																			xtype : 'panel',
																			title : '功能列表',
																			layout : 'fit',
																			name : 'menuPanel',
																		});
																		container = Ext.ComponentQuery.query('panel[name="menuPanel"]')[0];
																	}
																	;
																	tab.setActiveTab(1);
																	container.removeAll();
																	container.setTitle('小班对比');
																	var panel = Ext.create("MyApp.view.XBCompareView");
																	container.add(panel);
																	var me = panel.down('treepicker');
																	var record = Ext.getCmp('westTree').getSelectionModel().getSelection()[0];
																	if (record == undefined)
																		return;
																	me.displayTplData = [ record.data ];
																	me.setValue(record.get('value'));
																	me.setRawValue(record.get('text'));

																	// showDiffXB();
																}
															} ]
														}, {
															border : false,
															hidden : !hasPermisson(310),
															html : '<div class="splitLine"> </div>',
															width : 1
														}, {
															xtype : 'button',
															iconCls : 'stastics',
															text : '统计分析',
															hidden : !hasPermisson(310),
															scale : 'large',
															iconAlign : 'top',
															border : false,
															style : {
																background : '#117DCF'
															},
															width : 120,
															handler : function() {
																// var
																// tab =
																// Ext.ComponentQuery.query('panel[name="tabMenu"]')[0];
																// var
																// container
																// =
																// Ext.ComponentQuery.query('panel[name="menuPanel"]')[0];
																// if(!container){
																// tab.add({
																// xtype
																// :
																// 'panel',
																// width
																// :
																// 176,
																// title:'功能列表',
																// layout
																// :
																// 'fit',
																// name:'menuPanel',
																// } );
																// container
																// =
																// Ext.ComponentQuery.query('panel[name="menuPanel"]')[0];
																// };
																// tab.setActiveTab(1);
																// container.removeAll();
																// container.setTitle('统计分析');
																// var
																// panel
																// =
																// Ext.widget('statisticsWidget');
																// container.add(panel);

																var win = Ext.widget('statisticsWinWidget');
																win.show();
																// window.open(hostPath+"/statistics.jsp");
															}
														}, {
															border : false,
															name : 'split3d',
															hidden : !hasPermisson(410),
															html : '<div class="splitLine"> </div>',
															width : 1
														}, {
															xtype : 'button',
															iconCls : 'themeMap',
															text : '空间分析',
															name : 'spatial3D',
															hidden : !hasPermisson(410),
															scale : 'large',
															iconAlign : 'top',
															border : false,
															style : {
																background : '#117DCF'
															},
															width : 120,
															handler : function() {
																var tab = Ext.ComponentQuery.query('panel[name="tabMenu"]')[0];
																var container = Ext.ComponentQuery.query('panel[name="menuPanel"]')[0];
																if (!container) {
																	tab.add({
																		xtype : 'panel',
																		width : 176,
																		title : '功能列表',
																		layout : 'fit',
																		name : 'menuPanel',
																	});
																	container = Ext.ComponentQuery.query('panel[name="menuPanel"]')[0];
																}
																;
																tab.setActiveTab(1);
																container.removeAll();
																var panel = Ext.widget('spatialWidget');
																container.add(panel);
															}
														}, {
															border : false,
															hidden : !hasPermisson(510),
															html : '<div class="splitLine"> </div>',
															width : 1
														}, {
															xtype : 'button',
															iconCls : 'themeMap',
															text : '专题图',
															hidden : !hasPermisson(510),
															scale : 'large',
															iconAlign : 'top',
															border : false,
															style : {
																background : '#117DCF'
															},
															width : 120,
															handler : function() {
																var tab = Ext.ComponentQuery.query('panel[name="tabMenu"]')[0];
																var container = Ext.ComponentQuery.query('panel[name="menuPanel"]')[0];
																if (!container) {
																	tab.add({
																		xtype : 'panel',
																		width : 176,
																		title : '功能列表',
																		layout : 'fit',
																		name : 'menuPanel',
																	});
																	container = Ext.ComponentQuery.query('panel[name="menuPanel"]')[0];
																}
																;
																tab.setActiveTab(1);
																container.removeAll();
																container.setTitle('专题图');
																var panel = Ext.widget('thematicWidget');
																container.add(panel);
															}
														}, {
															border : false,
															hidden : !hasPermisson(610),
															html : '<div class="splitLine"> </div>',
															width : 1
														}, {
															xtype : 'button',
															iconCls : 'configs',
															hidden : !hasPermisson(610),
															text : '系统设置',
															scale : 'large',
															iconAlign : 'top',
															border : false,
															style : {
																background : '#117DCF'
															},
															width : 120,
															handler : function() {
																var tab = Ext.ComponentQuery.query('panel[name="tabMenu"]')[0];
																var container = Ext.ComponentQuery.query('panel[name="menuPanel"]')[0];
																if (!container) {
																	tab.add({
																		xtype : 'panel',
																		width : 176,
																		title : '功能列表',
																		layout : 'fit',
																		name : 'menuPanel',
																	});
																	container = Ext.ComponentQuery.query('panel[name="menuPanel"]')[0];
																}
																;
																tab.setActiveTab(1);
																container.removeAll();
																container.setTitle('系统设置');
																var panel = Ext.widget('sysManagerWidget');
																container.add(panel);
															}
														}, {
															border : false,
															html : '<div class="splitLine"> </div>',
															width : 1
														} ]
													},
													{
														xtype : 'tabpanel',
														region : 'west',
														name : 'tabMenu',
														id : 'west',
														split : true,
														width : 300,
														activeTab : 0,
														listeners : {
															tabchange : function(a, b, c, d) {
																if (c.title != '行政区划')
																	return;
																var me = b.down('treepicker');
																var record = Ext.getCmp('westTree').getSelectionModel().getSelection()[0];
																if (record == undefined)
																	return;
																if (me == null)
																	return;
																me.displayTplData = [ record.data ];
																me.setValue(record.get('value'));
																me.setRawValue(record.get('text'));
															}
														},
														items : [ {
															xtype : 'panel',
															title : '行政区划',
															layout : 'fit',
															items : [ {
																xtype : 'treepanel',
																id : 'westTree',
																header : false,
																name : 'xzqhTree',
																title : 'My Tree Panel',
																rootVisible : true,
																viewConfig : {

																},
																useArrows : true,
																columns : [ { // 定义tree的列
																	xtype : 'treecolumn',
																	text : '行政区划', // 显示的表头列名称
																	flex : 1,
																	sortable : true,
																	dataIndex : 'text' // 对应store的列字段名称
																} ],
																store : Ext.create('Ext.data.TreeStore', {
																	proxy : {
																		type : 'ajax',
																		// url:
																		// SystemTool.basePath
																		// +'/datas/data.txt'
																		url : SystemTool.basePath + '/j2UnitCode.jhtml?method=queryList'
																	},
																	root : {
																		expanded : true,
																		text : cur_areaName,// "辽宁省",
																		id : cur_areaID,// '0021',
																		leaf : false
																	// children:[{"id":"00210001","text":"沈阳市","code":"210100","codelevel":"2","leaf":false,"children":[{"id":"002100010003","text":"沈河区","code":"210103","codelevel":"3","leaf":false},{"id":"002100010004","text":"大东区","code":"210104","codelevel":"3","leaf":false},{"id":"002100010005","text":"皇姑区","code":"210105","codelevel":"3","leaf":true},{"id":"002100010011","text":"苏家屯区","code":"210111","codelevel":"3","leaf":true},{"id":"002100010012","text":"浑南区","code":"210112","codelevel":"3","leaf":true},{"id":"002100010013","text":"沈北新区","code":"210113","codelevel":"3","leaf":true},{"id":"002100010014","text":"于洪区","code":"210114","codelevel":"3","leaf":true},{"id":"002100010015","text":"沈阳经济技术开发区","code":"210115","codelevel":"3","leaf":true},{"id":"002100010022","text":"辽中区","code":"210122","codelevel":"3","leaf":true},{"id":"002100010023","text":"康平县","code":"210123","codelevel":"3","leaf":true},{"id":"002100010024","text":"法库县","code":"210124","codelevel":"3","leaf":true},{"id":"002100010051","text":"高新区","code":"210151","codelevel":"3","leaf":true},{"id":"002100010060","text":"沈煤集团","code":"210160","codelevel":"3","leaf":true},{"id":"002100010081","text":"新民市","code":"210181","codelevel":"3","leaf":true}]},{"id":"00210002","text":"大连市","code":"210200","codelevel":"2","leaf":false,"children":[{"id":"002100020004","text":"沙河口区","code":"210204","codelevel":"3","leaf":true},{"id":"002100020011","text":"甘井子区","code":"210211","codelevel":"3","leaf":true},{"id":"002100020012","text":"旅顺口区","code":"210212","codelevel":"3","leaf":true},{"id":"002100020013","text":"大连金州新区","code":"210213","codelevel":"3","leaf":true},{"id":"002100020015","text":"大连长兴岛临港工业区","code":"210215","codelevel":"3","leaf":true},{"id":"002100020016","text":"大连花园口经济区","code":"210216","codelevel":"3","leaf":true},{"id":"002100020017","text":"大连高新技术产业园区","code":"210217","codelevel":"3","leaf":true},{"id":"002100020018","text":"大连保税区","code":"210218","codelevel":"3","leaf":true},{"id":"002100020019","text":"普湾新区","code":"210219","codelevel":"3","leaf":true},{"id":"002100020024","text":"长海县","code":"210224","codelevel":"3","leaf":true},{"id":"002100020070","text":"仙人洞保护区","code":"210270","codelevel":"3","leaf":true},{"id":"002100020081","text":"瓦房店市","code":"210281","codelevel":"3","leaf":true},{"id":"002100020082","text":"普兰店市","code":"210282","codelevel":"3","leaf":true},{"id":"002100020083","text":"庄河市","code":"210283","codelevel":"3","leaf":true}]},{"id":"00210003","text":"鞍山市","code":"210300","codelevel":"2","leaf":false,"children":[{"id":"002100030002","text":"铁东区","code":"210302","codelevel":"3","leaf":true},{"id":"002100030003","text":"铁西区","code":"210303","codelevel":"3","leaf":true},{"id":"002100030011","text":"千山区","code":"210311","codelevel":"3","leaf":true},{"id":"002100030012","text":"鞍山经济技术开发区","code":"210312","codelevel":"3","leaf":true},{"id":"002100030015","text":"千山风景名胜区","code":"210315","codelevel":"3","leaf":true},{"id":"002100030016","text":"玉佛山风景区","code":"210316","codelevel":"3","leaf":true},{"id":"002100030018","text":"鞍山高新技术产业开发区","code":"210318","codelevel":"3","leaf":true},{"id":"002100030021","text":"台安县","code":"210321","codelevel":"3","leaf":true},{"id":"002100030023","text":"岫岩县","code":"210323","codelevel":"3","leaf":true},{"id":"002100030050","text":"市实验林场","code":"210350","codelevel":"3","leaf":true},{"id":"002100030081","text":"海城市","code":"210381","codelevel":"3","leaf":true}]},{"id":"00210004","text":"抚顺市","code":"210400","codelevel":"2","leaf":false,"children":[{"id":"002100040002","text":"新抚区","code":"210402","codelevel":"3","leaf":true},{"id":"002100040003","text":"东洲区","code":"210403","codelevel":"3","leaf":true},{"id":"002100040004","text":"望花区","code":"210404","codelevel":"3","leaf":true},{"id":"002100040011","text":"顺城区","code":"210411","codelevel":"3","leaf":true},{"id":"002100040021","text":"抚顺县","code":"210421","codelevel":"3","leaf":true},{"id":"002100040022","text":"新宾县","code":"210422","codelevel":"3","leaf":true},{"id":"002100040023","text":"清原县","code":"210423","codelevel":"3","leaf":true},{"id":"002100040050","text":"抚顺经济开发区","code":"210450","codelevel":"3","leaf":true},{"id":"002100040051","text":"大伙房林场","code":"210451","codelevel":"3","leaf":true},{"id":"002100040060","text":"抚煤集团","code":"210460","codelevel":"3","leaf":true}]},{"id":"00210005","text":"本溪市","code":"210500","codelevel":"2","leaf":false,"children":[{"id":"002100050002","text":"平山区","code":"210502","codelevel":"3","leaf":true},{"id":"002100050003","text":"溪湖区","code":"210503","codelevel":"3","leaf":true},{"id":"002100050004","text":"明山区","code":"210504","codelevel":"3","leaf":true},{"id":"002100050005","text":"南芬区","code":"210505","codelevel":"3","leaf":true},{"id":"002100050021","text":"本溪县","code":"210521","codelevel":"3","leaf":true},{"id":"002100050022","text":"桓仁县","code":"210522","codelevel":"3","leaf":true},{"id":"002100050050","text":"市实验林场","code":"210550","codelevel":"3","leaf":true},{"id":"002100050051","text":"本溪高新技术产业开发区","code":"210551","codelevel":"3","leaf":true},{"id":"002100050060","text":"矿柱林林场","code":"210560","codelevel":"3","leaf":true},{"id":"002100050070","text":"老秃顶保护区","code":"210570","codelevel":"3","leaf":true}]},{"id":"00210006","text":"丹东市","code":"210600","codelevel":"2","leaf":false,"children":[{"id":"002100060002","text":"元宝区","code":"210602","codelevel":"3","leaf":true},{"id":"002100060003","text":"振兴区","code":"210603","codelevel":"3","leaf":true},{"id":"002100060004","text":"振安区","code":"210604","codelevel":"3","leaf":true},{"id":"002100060005","text":"丹东边境经济合作区","code":"210605","codelevel":"3","leaf":true},{"id":"002100060006","text":"大孤山经济区","code":"210606","codelevel":"3","leaf":true},{"id":"002100060024","text":"宽甸县","code":"210624","codelevel":"3","leaf":true},{"id":"002100060050","text":"市园林处","code":"210650","codelevel":"3","leaf":true},{"id":"002100060070","text":"白石砬保护区","code":"210670","codelevel":"3","leaf":true},{"id":"002100060081","text":"东港市","code":"210681","codelevel":"3","leaf":true},{"id":"002100060082","text":"凤城市","code":"210682","codelevel":"3","leaf":true}]},{"id":"00210007","text":"锦州市","code":"210700","codelevel":"2","leaf":false,"children":[{"id":"002100070002","text":"古塔区","code":"210702","codelevel":"3","leaf":true},{"id":"002100070003","text":"凌河区","code":"210703","codelevel":"3","leaf":true},{"id":"002100070011","text":"太和区","code":"210711","codelevel":"3","leaf":true},{"id":"002100070012","text":"锦州经济技术开发区","code":"210712","codelevel":"3","leaf":true},{"id":"002100070026","text":"黑山县","code":"210726","codelevel":"3","leaf":true},{"id":"002100070027","text":"义县","code":"210727","codelevel":"3","leaf":true},{"id":"002100070051","text":"松山新区","code":"210751","codelevel":"3","leaf":true},{"id":"002100070053","text":"龙栖湾新区","code":"210753","codelevel":"3","leaf":true},{"id":"002100070070","text":"闾山保护区","code":"210770","codelevel":"3","leaf":true},{"id":"002100070081","text":"凌海市","code":"210781","codelevel":"3","leaf":true},{"id":"002100070082","text":"北镇市","code":"210782","codelevel":"3","leaf":true}]},{"id":"00210008","text":"营口市","code":"210800","codelevel":"2","leaf":false,"children":[{"id":"002100080004","text":"鲅鱼圈区","code":"210804","codelevel":"3","leaf":true},{"id":"002100080011","text":"老边区","code":"210811","codelevel":"3","leaf":true},{"id":"002100080081","text":"盖州市","code":"210881","codelevel":"3","leaf":true},{"id":"002100080082","text":"大石桥市","code":"210882","codelevel":"3","leaf":true}]},{"id":"00210009","text":"阜新市","code":"210900","codelevel":"2","leaf":false,"children":[{"id":"002100090002","text":"海州区","code":"210902","codelevel":"3","leaf":true},{"id":"002100090003","text":"新邱区","code":"210903","codelevel":"3","leaf":true},{"id":"002100090004","text":"太平区","code":"210904","codelevel":"3","leaf":true},{"id":"002100090005","text":"清河门区","code":"210905","codelevel":"3","leaf":true},{"id":"002100090011","text":"细河区","code":"210911","codelevel":"3","leaf":true},{"id":"002100090021","text":"阜蒙县","code":"210921","codelevel":"3","leaf":true},{"id":"002100090022","text":"彰武县","code":"210922","codelevel":"3","leaf":true},{"id":"002100090060","text":"阜煤集团","code":"210960","codelevel":"3","leaf":true}]},{"id":"00210010","text":"辽阳市","code":"211000","codelevel":"2","leaf":false,"children":[{"id":"002100100002","text":"白塔区","code":"211002","codelevel":"3","leaf":true},{"id":"002100100003","text":"文圣区","code":"211003","codelevel":"3","leaf":true},{"id":"002100100004","text":"宏伟区","code":"211004","codelevel":"3","leaf":true},{"id":"002100100005","text":"弓长岭区","code":"211005","codelevel":"3","leaf":true},{"id":"002100100011","text":"太子河区","code":"211011","codelevel":"3","leaf":true},{"id":"002100100021","text":"辽阳县","code":"211021","codelevel":"3","leaf":true},{"id":"002100100081","text":"灯塔市","code":"211081","codelevel":"3","leaf":true}]},{"id":"00210011","text":"盘锦市","code":"211100","codelevel":"2","leaf":false,"children":[{"id":"002100110002","text":"双台子区","code":"211102","codelevel":"3","leaf":true},{"id":"002100110003","text":"兴隆台区","code":"211103","codelevel":"3","leaf":true},{"id":"002100110021","text":"大洼县","code":"211121","codelevel":"3","leaf":true},{"id":"002100110022","text":"盘山县","code":"211122","codelevel":"3","leaf":true}]},{"id":"00210012","text":"铁岭市","code":"211200","codelevel":"2","leaf":false,"children":[{"id":"002100120002","text":"银州区","code":"211202","codelevel":"3","leaf":true},{"id":"002100120004","text":"清河区","code":"211204","codelevel":"3","leaf":true},{"id":"002100120005","text":"铁岭经济开发区","code":"211205","codelevel":"3","leaf":true},{"id":"002100120021","text":"铁岭县","code":"211221","codelevel":"3","leaf":true},{"id":"002100120023","text":"西丰县","code":"211223","codelevel":"3","leaf":true},{"id":"002100120024","text":"昌图县","code":"211224","codelevel":"3","leaf":true},{"id":"002100120060","text":"铁煤集团","code":"211260","codelevel":"3","leaf":true},{"id":"002100120081","text":"调兵山市","code":"211281","codelevel":"3","leaf":true},{"id":"002100120082","text":"开原市","code":"211282","codelevel":"3","leaf":true}]},{"id":"00210013","text":"朝阳市","code":"211300","codelevel":"2","leaf":false,"children":[{"id":"002100130002","text":"双塔区","code":"211302","codelevel":"3","leaf":true},{"id":"002100130003","text":"龙城区","code":"211303","codelevel":"3","leaf":true},{"id":"002100130021","text":"朝阳县","code":"211321","codelevel":"3","leaf":true},{"id":"002100130022","text":"建平县","code":"211322","codelevel":"3","leaf":true},{"id":"002100130024","text":"喀左县","code":"211324","codelevel":"3","leaf":true},{"id":"002100130050","text":"朝阳开发区","code":"211350","codelevel":"3","leaf":true},{"id":"002100130070","text":"怒鲁儿虎保护区","code":"211370","codelevel":"3","leaf":true},{"id":"002100130081","text":"北票市","code":"211381","codelevel":"3","leaf":true},{"id":"002100130082","text":"凌源市","code":"211382","codelevel":"3","leaf":true}]},{"id":"00210014","text":"葫芦岛市","code":"211400","codelevel":"2","leaf":false,"children":[{"id":"002100140002","text":"连山区","code":"211402","codelevel":"3","leaf":true},{"id":"002100140003","text":"龙港区","code":"211403","codelevel":"3","leaf":true},{"id":"002100140004","text":"南票区","code":"211404","codelevel":"3","leaf":true},{"id":"002100140005","text":"杨家杖子经济开发区","code":"211405","codelevel":"3","leaf":true},{"id":"002100140021","text":"绥中县","code":"211421","codelevel":"3","leaf":true},{"id":"002100140022","text":"建昌县","code":"211422","codelevel":"3","leaf":true},{"id":"002100140060","text":"葫芦岛市生态实验林场","code":"211460","codelevel":"3","leaf":true},{"id":"002100140081","text":"兴城市","code":"211481","codelevel":"3","leaf":true}]},{"id":"00210090","text":"省直","code":"219000","codelevel":"2","leaf":false,"children":[{"id":"002100900001","text":"省实验林场","code":"219001","codelevel":"3","leaf":true},{"id":"002100900002","text":"省林校林场","code":"219002","codelevel":"3","leaf":true},{"id":"002100900003","text":"省经营所","code":"219003","codelevel":"3","leaf":true},{"id":"002100900004","text":"省固沙所","code":"219004","codelevel":"3","leaf":true},{"id":"002100900005","text":"省经济林所","code":"219005","codelevel":"3","leaf":true},{"id":"002100900006","text":"省杨树所","code":"219006","codelevel":"3","leaf":true},{"id":"002100900007","text":"省干旱所","code":"219007","codelevel":"3","leaf":true},{"id":"002100900008","text":"省生态林场","code":"219008","codelevel":"3","leaf":true},{"id":"002100900009","text":"省野保中心","code":"219009","codelevel":"3","leaf":true}]}]
																	},
																	// autoLoad:true,
																	fields : [ 'text', 'value', 'codelevel', 'code' ]
																// 跟旧版本extjs一样，节点的id和显示文本
																}),
																listeners : {
																	itemclick : function(tree, record, item, index, e, eOpts) {
																		queryXZQH(record.get('codelevel'), record.get('code'), locateXZQH);
																		queryXZQH(record.get('codelevel'), record.get('code'), areaInfoShowCallBack);
																	}
																}
															} ]
														} ]
													},
													{
														xtype : 'panel',
														name : 'main-container',
														layout : 'fit',
														region : 'center',
														items : [ {
															xtype : 'tabpanel',
															// region: 'center',
															name : 'tabMain',
															deferredRender : false,
															margin : '-36 0 0 0',
															items : [
																	{
																		xtype : 'panel',
																		title : '三维视图',
																		dockedItems : [ {
																			xtype : 'toolbar',

																			dock : 'top',
																			items : [
																					// <img
																					// id="change3d"
																					// class="hover"
																					// src="images/header/earth.png"
																					// style="height:60px;width:86px;position:absolute;bottom:16px;left:10px;z-index:2"/>
																					{
																						text : '二维',
																						id : 'change2d',
																						handler : function() {
																							// <img
																							// class="hover"
																							// id="change2d"
																							// src="images/header/map.png"
																							// style="display:block;height:60px;width:86px;position:absolute;bottom:16px;left:10px;z-index:19002;float:left;"/>
																						}
																					},
																					{
																						xtype : 'tbfill'
																					},
																					{
																						xtype : 'button',
																						text : '定位',
																						name : 'locate3d',
																						menu : new Ext.menu.Menu({
																							// 设置菜单四条边都有阴影
																							shadow : 'frame',
																							listeners : {
																								hide : function() {
//																									theApplet.clicked = 1;
																									// Ext.get(Ext.query('#change2d')[0]).createShim()
																									// ;
																								}
																							// ,show:function(){
																							// console.log('show');
																							// }
																							},
																							// 添加菜单项
																							items : [
																									{
																										text : '小班定位',
																										iconCls : 'measure',
																										handler : function() {

																											var xbPositionWindow1 = Ext.getCmp('xbPositionWindow1');
																											if (xbPositionWindow1 == undefined) {
																												xbPositionWindow1 = new Ext.Window({
																													id : "xbPositionWindow1",
																													title : '小班林班定位',
																													width : 350,
																													height : 200,
																													layout : 'fit',
																													collapsible : true,
																													autoScroll : false,
																													modal : false,
																													closeAction : 'hide',
																													y : 100,
																													resizable : false,
																													plain : false,
																													minButtonWidth : 50,
																													items : [ new Ext.FormPanel({
																														labelAlign : 'left',
																														bodyStyle : 'padding:5px',
																														width : 280,
																														height : 180,
																														// layout:'anchor',
																														labelWidth : 50,
																														border : false,
																														items : [
																																{
																																	xtype : 'treepicker',
																																	fieldLabel : '行政区划',
																																	labelAlign : 'right',
																																	labelWidth : 80,
																																	// layout:'fit',
																																	anchor : '100%',
																																	margin : 10,
																																	listeners : {
																																		expand : function() {
																																			this.getPicker().getEl().prev(".x-shim").setStyle(
																																					"display", "block");
																																		}
																																	},
																																	name : 'unitID',
																																	displayField : 'text',
																																	valueField : 'value',
																																	rootVisible : true,
																																	minPickerHeight : 400,
																																	maxPickerHeight : 400,
																																	// height:18,
																																	store : Ext.create('Ext.data.TreeStore', {
																																		fields : [ 'text', 'value', 'codelevel', 'code' ],
																																		root : {
																																			expanded : true,
																																			text : cur_areaName,// "辽宁省",
																																			id : cur_areaID,// '0021',
																																			leaf : false
																																		},
																																		proxy : {
																																			type : 'ajax',
																																			url : hostPath + '/j2UnitCode.jhtml?method=queryList',
																																			reader : {
																																				type : 'json'
																																			}
																																		}
																																	})
																																}, {
																																	xtype : 'textfield',
																																	fieldLabel : '林班号',
																																	labelAlign : 'right',
																																	labelWidth : 80,
																																	anchor : '100%',
																																	id : 'positioner_linban1',
																																	name : 'positioner_linban',
																																	allowBlank : true
																																}, {
																																	xtype : 'textfield',
																																	fieldLabel : '小班号',
																																	labelAlign : 'right',
																																	labelWidth : 80,
																																	anchor : '100%',
																																	id : 'positioner_xiaoban1',
																																	name : 'positioner_xiaoban',
																																	allowBlank : true
																																} ],
																														buttons : [ {
																															text : '定位',
																															listeners : {
																																click : function() {
																																	resetFunc();
																																	var treepicker = xbPositionWindow1.down('treepicker');
																																	var areaCode = treepicker.displayTplData[0].code;
																																	var codelevel = treepicker.displayTplData[0].codelevel;
																																	var cun = areaCode;// Ext.getCmp('areaID1').code;
																																	var lbh = Ext.getCmp('positioner_linban1').getValue();
																																	var xbh = Ext.getCmp('positioner_xiaoban1').getValue();
																																	Ext.getCmp('xbPositionWindow1').hide();
																																	locateXB(cun, lbh, xbh, function(req) {
																																		var g = new OpenLayers.Format.GML();
																																		var features = g.read(req.responseText);
																																		removedAllShape();
																																		if (features.length > 0) {
																																			var feature = features[0];
																																			var components = feature.geometry.components[0].components;
																																			for (var i = 0; i < components.length; i++) {
																																				var points = components[i].getVertices();
																																				var pointStr = "";// 33.5,125;
																																				for (var j = 0; j < points.length; j++) {
																																					if (pointStr == "") {
																																						pointStr = points[j].y + "," + points[j].x;
																																					} else {
																																						pointStr = pointStr + "|" + points[j].y + ","
																																								+ points[j].x;
																																					}
																																				}
																																				addSurfacePolygon(pointStr, "blue", "lightGray", 0.5,
																																						feature.attributes.c_xb + i);
																																			}
																																			flyToLocation(feature.geometry.getCentroid().y,
																																					feature.geometry.getCentroid().x, 0, 0, 0, 3000);
																																			// flyTo(feature.geometry.getCentroid().y,feature.geometry.getCentroid().x);
																																			addMarker(feature.geometry.getCentroid().y,
																																					feature.geometry.getCentroid().x, "null");// /../../../../../com/sx
																																		} else {
																																			noXB();
																																			return;
																																		}
																																	});
																																	// flyTo(lat,lon);
																																}
																															}
																														} ]
																													})
																													// ,
																													// new
																													// Ext.FormPanel({
																													// labelAlign:
																													// 'left',
																													// bodyStyle:'padding:5px',
																													// width:250,
																													// height:120,
																													// labelWidth:50,
																													// border:false,
																													// items:
																													// [
																													// {
																													// xtype:"myComboxTree",emptyText:'请选择地区',id:'areaID1',width:150,
																													// fieldLabel:
																													// "地
																													// 区",
																													// allowBlank:true,
																													// tree:new
																													// Ext.tree.TreePanel({
																													// id:'dqTree1-',
																													// root
																													// :
																													// new
																													// Ext.tree.AsyncTreeNode({id:'0',text
																													// :'根节点',value:'',codelevel:'',expanded:true,leaf:false}),
																													// loader
																													// :
																													// new
																													// Ext.tree.TreeLoader({
																													// url
																													// :SystemTool.basePath+'/j2UnitCode.jhtml?method=queryList',
																													// baseParams:{pcode:''},
																													// listeners:{
																													// beforeLoad:function(loaderObj,node){
																													// loaderObj.baseParams.pcode
																													// =
																													// node.id;
																													// }
																													// }
																													// }),
																													// border
																													// :
																													// false,
																													// rootVisible
																													// :
																													// false,
																													// lines
																													// :
																													// false,
																													// autoScroll
																													// :
																													// true
																													// })
																													// },
																													// {
																													// xtype
																													// :
																													// 'textfield',
																													// fieldLabel:
																													// '林班号',
																													// id:'positioner_linban',
																													// allowBlank:true
																													// },
																													// {
																													// xtype
																													// :
																													// 'textfield',
																													// fieldLabel:
																													// '小班号',
																													// id:'positioner_xiaoban',
																													// allowBlank:true
																													// }
																													// ],
																													// buttons:
																													// [{
																													// text:
																													// '定位',
																													// listeners:
																													// {
																													// click
																													// :function(){
																													// var
																													// cun
																													// =
																													// Ext.getCmp('areaID1').code;
																													// var
																													// lbh
																													// =
																													// Ext.getCmp('positioner_linban').getValue();
																													// var
																													// xbh
																													// =
																													// Ext.getCmp('positioner_xiaoban').getValue();
																													// Ext.getCmp('xbPositionWindow').hide();
																													// queryTool2D.locateXB(cun,lbh,xbh,function(req){
																													// var
																													// g =
																													// new
																													// OpenLayers.Format.GML();
																													// var
																													// features
																													// =
																													// g.read(req.responseText);
																													// removedAllShape();
																													// if(features.length>0){
																													// var
																													// feature=features[0];
																													// var
																													// components=feature.geometry.components[0].components;
																													// for(var
																													// i=0;i<components.length;i++){
																													// var
																													// points=components[i].getVertices();
																													// var
																													// pointStr="";//33.5,125;
																													// for(var
																													// j=0;j<points.length;j++){
																													// if(pointStr==""){
																													// pointStr=points[j].y+","+points[j].x;
																													// }else{
																													// pointStr=pointStr+"|"+points[j].y+","+points[j].x;
																													// }
																													// }
																													// addSurfacePolygon(pointStr,"blue","lightGray",0.5,feature.attributes.c_xb+i);
																													// }
																													// flyTo(feature.geometry.getCentroid().y,feature.geometry.getCentroid().x);
																													// addMarker(feature.geometry.getCentroid().y,feature.geometry.getCentroid().x,"null");///../../../../../com/sx
																													// }
																													// });
																													// //flyTo(lat,lon);
																													// }
																													// }
																													// }
																													// ]
																													// })
																													]
																												});
																											}
																											xbPositionWindow1.show();
																											var me = xbPositionWindow1.down('treepicker');
																											var record = Ext.getCmp('westTree').getSelectionModel().getSelection()[0];
																											if (record == undefined)
																												return;
																											me.displayTplData = [ record.data ];
																											me.setValue(record.get('value'));
																											me.setRawValue(record.get('text'));
																											// xbPositionWindow.down('treepicker').selectItem(Ext.getCmp('westTree').getSelectionModel().getSelection()[0]);
																										}
																									},
																									{
																										text : '经纬度定位',
																										iconCls : 'area',
																										handler : function() {
																											var latlonPositionerWindow1 = Ext.getCmp('latlonPositionerWindow1');
																											if (latlonPositionerWindow1 == undefined) {
																												latlonPositionerWindow1 = new Ext.Window({
																													id : "latlonPositionerWindow1",
																													title : '经纬度定位',
																													width : 350,
																													height : 160,
																													autoScroll : false,
																													modal : false,
																													closeAction : 'hide',
																													resizable : false,
																													plain : false,
																													layout : 'fit',
																													minButtonWidth : 50,
																													items : [ new Ext.FormPanel(
																															{
																																labelAlign : 'left',
																																bodyStyle : 'padding:5px',
																																// width:300,
																																// height:120,
																																labelWidth : 50,
																																border : false,
																																items : [ {
																																	xtype : 'numberfield',
																																	fieldLabel : '经度',
																																	id : 'latlonPositioner_lon1',
																																	allowBlank : false,
																																	anchor : '100%',
																																	minValue : -180,
																																	maxValue : 180
																																}, {
																																	xtype : 'numberfield',
																																	fieldLabel : '纬度',
																																	anchor : '100%',
																																	id : 'latlonPositioner_lat1',
																																	allowBlank : false,
																																	minValue : -180,
																																	maxValue : 180
																																} ],
																																buttons : [ {
																																	text : '定位',
																																	listeners : {
																																		click : function() {
																																			resetFunc();
																																			var lon = parseFloat(Ext.getCmp('latlonPositioner_lon1')
																																					.getValue());
																																			var lat = parseFloat(Ext.getCmp('latlonPositioner_lat1')
																																					.getValue());
																																			Ext.getCmp('latlonPositionerWindow1').hide();
																																			flyTo(lat, lon);
																																			addMarker(lat, lon, "null");
																																		}
																																	}
																																} ]
																															}) ]
																												});
																											}
																											latlonPositionerWindow1.show();
																										}
																									},
																									{
																										text : '高斯定位',
																										iconCls : 'high',
																										handler : function() {
																											// IndexTool.stopAllTool();
																											// startMeasureHeight();
																											var gaussPositionWindow1 = Ext.getCmp('gaussPositionWindow1');
																											if (gaussPositionWindow1 == undefined) {
																												gaussPositionWindow1 = new Ext.Window({
																													id : 'gaussPositionWindow1',
																													title : '高斯坐标定位',
																													width : 350,
																													height : 180,
																													// y:115,
																													autoScroll : false,
																													modal : false,
																													closeAction : 'hide',
																													layout : 'fit',
																													resizable : false,
																													plain : false,
																													minButtonWidth : 60,
																													items : [ new Ext.FormPanel(
																															{
																																labelAlign : 'left',
																																bodyStyle : 'padding:5px',
																																labelWidth : 40,
																																border : false,
																																// layout:'column',
																																items : [ new Ext.form.ComboBox({
																																	id : 'gaussPositioner_fendai1',
																																	fieldLabel : '分带',
																																	store : new Ext.data.SimpleStore({
																																		fields : [ 'display' ],
																																		data : [ [ '3度带' ], [ '6度带' ] ]
																																	}),
																																	displayField : 'display',
																																	valueField : 'display',
																																	mode : 'local',
																																	anchor : '100%',
																																	triggerAction : 'all',
																																	selectOnFocus : true,
																																	// width:100,
																																	emptyText : '请选择',
																																	listeners : {
																																		'select' : function() {

																																		}
																																	}
																																}), {
																																	xtype : 'numberfield',
																																	fieldLabel : 'X坐标',
																																	// width:100,
																																	anchor : '100%',
																																	id : 'gaussPositioner_x1',
																																	allowBlank : false
																																}, {
																																	xtype : 'textfield',
																																	fieldLabel : '  ',
																																	// width:100,
																																	anchor : '100%',
																																	id : 'gaussPositioner_daihao1',
																																	allowBlank : true,
																																	hidden : true
																																}, {
																																	xtype : 'numberfield',
																																	fieldLabel : 'Y坐标',
																																	// width:100,
																																	anchor : '100%',
																																	id : 'gaussPositioner_y1',
																																	allowBlank : false
																																} ],
																																buttons : [ {
																																	text : '定位',
																																	listeners : {
																																		click : function() {
																																			resetFunc();
																																			if ($('gaussPositioner_fendai1').value == '请选择') {
																																				Ext.Msg.alert('系统提示', '请选择分带。');
																																				return;
																																			}

																																			var z = parseFloat(Ext.getCmp('gaussPositioner_fendai1')
																																					.getValue());
																																			var x = parseFloat(Ext.getCmp('gaussPositioner_x1')
																																					.getValue());
																																			var y = parseFloat(Ext.getCmp('gaussPositioner_y1')
																																					.getValue());
																																			var temp = 0;
																																			if(z=="6"){
																																				temp = 1;
																																			}

																																		    var lonlat = GaussToBL2(x,y,temp);
																																			flyTo(lonlat.lat, lonlat.lon);
																																			addMarker(lonlat.lat, lonlat.lon,"null");

																																		}
																																	}
																																} ]
																															}) ]
																												});
																											}
																											gaussPositionWindow1.show();
																										}
																									} ,{

																										text : '图幅定位',
																										iconCls : 'high',
																										handler : function() {
																											// IndexTool.stopAllTool();
																											// startMeasureHeight();
																											var picPositionWindow = Ext.getCmp('picPositionWindow');
																											if (picPositionWindow == undefined) {
																												picPositionWindow = new Ext.Window({
																													id : 'picPositionWindow',
																													// y:115,
																													autoScroll : false,
																													modal : false,
																													closeAction : 'hide',
																													 height: 152,
																													    width: 342,
																													    layout: 'fit',
																													    defaultButton: '',
																													    title: '图幅定位',
																													    items: [
																													        {
																													            xtype: 'tabpanel',
																													            activeTab: 0,
																													            items: [
																													                {
																													                    xtype: 'panel',
																													                    style: {
																													                        lineHeight: '30px'
																													                    },
																													                    title: '旧图幅号',
																													                    layout: {
																													                        type: 'hbox',
																													                        align: 'stretch'
																													                    },
																													                    items: [
																													                        {
																													                            xtype: 'textfield',
																													                            flex: 4,
																													                            fieldLabel: '',
																													                            labelSeparator: '',
																													                            fieldCls: '',
																													                            margin:'5,0,5,0'
																													                        },
																													                        {
																													                            xtype: 'container',
																													                            flex: 0,
																													                            html: '－',
																													                            style: {
																													                                lineHeight: '30px'
																													                            }
																													                        },
																													                        {
																													                            xtype: 'textfield',
																													                            flex: 4,
																													                            fieldLabel: '',
																													                            margin:'5,0,5,0'
																													                        },
																													                        {
																													                            xtype: 'container',
																													                            flex: 0,
																													                            html: '－',
																													                            style: {
																													                                lineHeight: '30px'
																													                            }
																													                        },
																													                        {
																													                            xtype: 'textfield',
																													                            flex: 4,
																													                            fieldLabel: '',
																													                            margin:'5,0,5,0'
																													                        },
																													                        {
																													                            xtype: 'container',
																													                            flex: 0,
																													                            html: '－(',
																													                            style: {
																													                                lineHeight: '30px'
																													                            }
																													                        },
																													                        {
																													                            xtype: 'textfield',
																													                            flex: 4,
																													                            fieldLabel: '',
																													                            margin:'5,0,5,0'
																													                        },
																													                        {
																													                            xtype: 'container',
																													                            flex: 1,
																													                            html: ')'
																													                        }
																													                    ]
																													                },
																													                {
																													                    xtype: 'panel',
																													                    style: {
																													                        lineHeight: '30px'
																													                    },
																													                    title: '新图幅号',
																													                    layout: {
																													                        type: 'hbox',
																													                        align: 'stretch'
																													                    },
																													                    items: [
																													                        {
																													                            xtype: 'textfield',
																													                            flex: 4,
																													                            fieldLabel: '',
																													                            margin:'5,0,5,0'
																													                        }
																													                    ]
																													                }
																													            ]
																													        }
																													    ],
																													    dockedItems: [
																													        {
																													            xtype: 'toolbar',
																													            dock: 'bottom',
																													            layout: {
																													                type: 'hbox',
																													                align: 'middle',
																													                pack: 'end'
																													            },
																													            items: [
																													                {
																													                    xtype: 'button',
																													                    text: '定位',
																													                    handler:function(){
																													                    	resetFunc();
																													                    	if(picPositionWindow.down('tabpanel').getActiveTab().title=="旧图幅号"){
																													                    		  var textFields  = picPositionWindow.query("panel[title='旧图幅号'] textfield");
																													                    		  var arg1 = parseInt(textFields[0].getValue());
																													                    		  var arg2 = parseInt(textFields[1].getValue());
																													                    		  var arg3 = parseInt(textFields[2].getValue());
																													                    		  var arg4 = parseInt(textFields[3].getValue());

																													                    		  var bound = getBounds(arg1,arg2,arg3,arg4);
																															                    	 flyToLocation(bound.getCenterLonLat().lat,bound.getCenterLonLat().lon,0,0,0,17000);
																																						addMarker(bound.getCenterLonLat().lat, bound.getCenterLonLat().lon, "null");
																																						var pointStr="";
																																						var components = bound.toGeometry().components;
																																						for(var ii=0;ii<components.length;ii++){
																																							var points=components[ii].getVertices();
																																							// 33.5,125;
																																							for(var j=0;j<points.length;j++){
																																								if(pointStr==""){
																																									pointStr=points[j].y+","+points[j].x;
																																								}else{
																																									pointStr=pointStr+"|"+points[j].y+","+points[j].x;
																																								}
																																							}
																																							
																																						}
																																						addSurfacePolygon(pointStr,"blue","lightGray",0.5,1000);
																													                    		}else{
																													                    		  var textFields  = picPositionWindow.query("panel[title='新图幅号'] textfield");
																													                    		  var data = textFields[0].getValue();
																													                    		  var arg1 = data.substring(0,1);
																													                    		  var arg2 = parseInt(data.substring(1,3));
																													                    		  var arg3 = parseInt(data.substring(8,11));
																													                    		  var arg4 = parseInt(data.substring(4,7));

																													                    		  var bound = getBounds(arg1,arg2,arg3,arg4);
																															                    	 flyToLocation(bound.getCenterLonLat().lat,bound.getCenterLonLat().lon,0,0,0,17000);
																																						addMarker(bound.getCenterLonLat().lat, bound.getCenterLonLat().lon, "null");
																																						var pointStr="";
																																						var components = bound.toGeometry().components;
																																						for(var ii=0;ii<components.length;ii++){
																																							var points=components[ii].getVertices();
																																							// 33.5,125;
																																							for(var j=0;j<points.length;j++){
																																								if(pointStr==""){
																																									pointStr=points[j].y+","+points[j].x;
																																								}else{
																																									pointStr=pointStr+"|"+points[j].y+","+points[j].x;
																																								}
																																							}
																																							
																																						}
																																						addSurfacePolygon(pointStr,"blue","lightGray",0.5,1000);
																													                    		}

																													                    	
																													                    }
																													                }
																													            ]
																													        }
																													    ]
																												});
																											}
																											picPositionWindow.show();
																										}
																									
																									}]
																						})
																					},
																					{
																						text : '拔高设置',
																						handler : function() {
																							var vtcExaggerWin = Ext.getCmp('vtcExaggerWin');
																							if (vtcExaggerWin == null) {
																								vtcExaggerWin = Ext.create('Ext.Window', {
																									title : '拔高设置',
																									height : 150,
																									width : 250,
																									layout : 'anchor',
																									bodyPadding : 10,
																									closeAction : 'hide',
																									items : [ {
																										xtype : 'textfield',
																										fieldLabel : '拔高比例',
																										anchor : '100%',
																										value : '1'
																									} ],
																									buttons : [ {
																										text : '确定',
																										handler : function() {
																											setVerticalExaggeration(parseFloat(this.up('window').down('textfield').getValue()));
																											vtcExaggerWin.hide();
																											resetFunc();
																										}
																									} ]

																								})
																							}
																							vtcExaggerWin.show();
																						}
																					},
																					// {
																					// text:'reset',
																					// handler:function(){
																					// Ext.get(Ext.query('#change2d')[0]).createShim()
																					// ;
																					// }
																					// },
																					/*
																					 * { text : '放大', iconCls : 'zin', handler : function(){ zoomIn(); } }, '-', { text : '缩小',
																					 * iconCls : 'zout', handler : function(){ zoomOut(); } },'-',
																					 */{
																						xtype : 'combobox',
																						width : 100,
																						id : 'scaleCbx',
																						// fieldLabel:
																						// '比例尺',
																						labelAlign : 'right',
																						// labelWidth:
																						// 40,
																						valueField : 'scale',
																						displayField : 'scale',
																						autoSelect : false,
																						queryMode : 'local',
																						store : new Ext.data.SimpleStore({
																							data : [ [ 3000000 ], [ 2000000 ], [ 1000000 ], [ 500000 ], [ 200000 ], [ 100000 ], [ 50000 ], [ 20000 ],
																									[ 10000 ], [ 5000 ], [ 2000 ], [ 1000 ] ],
																							fields : [ 'scale' ]
																						}),
																						listeners : {
																							select : function(me, e) {
																								resetFunc();
																								setZoom1(me.getRawValue(), 1000);

																							},
																							collapse : function() {
//																								theApplet.clicked = 1;
																								// setTimeout(function(){Ext.get(Ext.query('#change2d')[0]).createShim();}
																								// ,1000);
																							},
																							specialkey : function(me, e) {
																								// e.HOME,
																								// e.END,
																								// e.PAGE_UP,
																								// e.PAGE_DOWN,
																								// e.TAB,
																								// e.ESC,
																								// arrow
																								// keys:
																								// e.LEFT,
																								// e.RIGHT,
																								// e.UP,
																								// e.DOWN
																								if (e.getKey() == e.ENTER) {
																									// console.log(me.getRawValue());
																									resetFunc();
																									setZoom1(me.getRawValue(), 1000);
																								}
																							}
																						}
																					},
																					{
																						text : '漫游',
																						iconCls : 'fly',
																						handler : function() {
																							IndexTool.stopAllTool();
																							removeMouseClickListenerFunc();
																							isClickXBShow = false;
																							// removedAllShape();
																						}
																					},
																					'-',
																					// {
																					// text:'测量',
																					// menu:new
																					// Ext.menu.Menu({
																					// //设置菜单四条边都有阴影
																					// shadow
																					// :
																					// 'frame',
																					// //添加菜单项
																					// items:[
																					// {
																					// text
																					// :
																					// '测距离',
																					// iconCls
																					// :
																					// 'measure',
																					// handler
																					// :
																					// function(){
																					// IndexTool.stopAllTool();
																					// startMeasureDistance('0');
																					// }
																					// },
																					// {
																					// text
																					// :
																					// '测面积',
																					// iconCls
																					// :
																					// 'area',
																					// handler
																					// :
																					// function(){
																					// IndexTool.stopAllTool();
																					// startMeasureArea('1');
																					// }
																					// },
																					// {
																					// text
																					// :
																					// '测高度',
																					// iconCls
																					// :
																					// 'high',
																					// handler:function(){
																					// IndexTool.stopAllTool();
																					// startMeasureHeight();
																					// }
																					// },
																					// {
																					// text
																					// :
																					// '测体积',
																					// iconCls
																					// :
																					// 'high',
																					// handler:function(){
																					// IndexTool.stopAllTool();
																					// startMeasureVolume();
																					// }
																					// }
																					// ]
																					// })
																					// }
																					{
																						text : '垂直',
																						// iconCls:'zhuji',
																						handler : function() {
																							setVertical();
																							resetFunc();
																						}
																					},
																					'-',
																					{
																						text : '指北',
																						iconCls : 'zhuji',
																						handler : function() {
																							setNorth();
																							resetFunc();
																						}
																					},
																					'-',
																					{
																						xtype : 'button',
																						text : '小班查询',
																						menu : new Ext.menu.Menu({
																							// 设置菜单四条边都有阴影
																							shadow : 'frame',
																							// 添加菜单项
																							items : [ {
																								text : '点选 查询',
																								iconCls : 'selectByPnt',
																								handler : function() {
																									removedAllShape();
																									addMouseClickListenerFunc('xb');
																									isClickXBShow = true;
																								}
																							}, {
																								text : '多边形查询',
																								handler : function() {
																									resetFunc();
																									startPolygonAnalysis();
																									// map.controls[10].activate();
																								}
																							} ]
																						})
																					},
																					{
																						text : '行政区查询',
																						iconCls : 'selectByPolygon2',
																						menu : new Ext.menu.Menu({
																							// 设置菜单四条边都有阴影
																							shadow : 'frame',
																							// 添加菜单项
																							items : [ {
																								text : '县(区)级查询',
																								handler : function() {
																									selectLayer = 'xian';
																									removeMouseClickListenerFunc();
																									removedAllShape();
																									addMouseClickListenerFunc('xz');
																									isClickXBShow = true;
																								}
																							}, {
																								text : '乡(场)级查询',
																								handler : function() {
																									selectLayer = 'xiang';
																									removedAllShape();
																									addMouseClickListenerFunc('xz');
																									isClickXBShow = true;
																								}
																							}, {
																								text : '村级查询',
																								handler : function() {
																									selectLayer = 'cun';
																									removedAllShape();
																									addMouseClickListenerFunc('xz');
																									isClickXBShow = true;
																								}
																							} ]
																						})
																					// ,
																					// handler:function(){
																					// removeAllShape();
																					// addMouseClickListenerFunc('xz');
																					// isClickXBShow=true;
																					// }
																					},
																					'-',
																					{
																						text : '典型场景',
																						menu : new Ext.menu.Menu(
																								{
																									items : [
																											{
																												text : '创建场景',
																												handler : function() {
																													resetFunc();
																													var createSceneWindow = Ext.getCmp('createSceneWindow');
																													if (createSceneWindow == undefined) {
																														createSceneWindow = new Ext.Window(
																																{
																																	id : 'createSceneWindow',
																																	title : '创建场景',
																																	width : 300,
																																	height : 110,
																																	autoScroll : false,
																																	modal : false,
																																	closeAction : 'hide',
																																	resizable : false,
																																	plain : false,
																																	minButtonWidth : 50,
																																	items : [ new Ext.FormPanel(
																																			{
																																				labelAlign : 'left',
																																				bodyStyle : 'padding:5px',
																																				autoWidth : true,
																																				border : false,
																																				items : [ {
																																					xtype : 'textfield',
																																					fieldLabel : '场景名称',
																																					id : 'sceneInput_name',
																																					allowBlank : false
																																				} ],
																																				buttons : [
																																						{
																																							text : '提交',
																																							listeners : {
																																								click : function() {
																																									var wwd = theApplet
																																											.getWorldwindOption()
																																											.getWwd();
																																									var sceneName = Ext.getCmp(
																																											'sceneInput_name')
																																											.getValue(), height = wwd
																																											.getView()
																																											.getCurrentEyePosition()
																																											.getElevation();
																																									// var
																																									// sceneName=Ext.get('sceneInput_name').dom.value,height=wwd.getView().getCurrentEyePosition().getElevation();
																																									var lon = wwd.getView()
																																											.getCurrentEyePosition()
																																											.getLongitude()
																																											.getDegrees(), lat = wwd
																																											.getView()
																																											.getCurrentEyePosition()
																																											.getLatitude().getDegrees();
																																									var pitch = wwd.getView()
																																											.getPitch().getDegrees(), heading = wwd
																																											.getView().getHeading()
																																											.getDegrees(), zoom = wwd
																																											.getView().getZoom();
																																									Ext.Ajax
																																											.request({
																																												url : SystemTool.basePath
																																														+ '/scene.jhtml?method=add',
																																												params : {
																																													name : sceneName,
																																													lon : lon,
																																													lat : lat,
																																													height : height,
																																													pitch : pitch,
																																													heading : heading,
																																													zoom : zoom
																																												},
																																												method : 'POST',
																																												success : function(
																																														response,
																																														options) {
																																													var responseJson = Ext.JSON
																																															.decode(response.responseText);
																																													Ext.Msg
																																															.alert(
																																																	'系统提示',
																																																	responseJson.msg);
																																													Ext
																																															.getCmp(
																																																	'createSceneWindow')
																																															.hide();
																																													loadSceneMenu();
																																												}
																																											});
																																								}
																																							}
																																						},
																																						{
																																							text : '取消',
																																							listeners : {
																																								click : function() {
																																									Ext.getCmp('createSceneWindow')
																																											.hide();
																																								}
																																							}
																																						} ]
																																			}) ]
																																});
																													}
																													createSceneWindow.show();
																													resetFunc();
																												}
																											}, {
																												text : '管理场景',
																												handler : function() {
																													new Ext.Window({
																														title : '管理场景',
																														width : 300,
																														y : 130,
																														autoScroll : true,
																														modal : false,
																														closeAction : 'hide',
																														resizable : false,
																														plain : false,
																														minButtonWidth : 60,
																														layout : 'column',
																														items : [ new Ext.grid.GridPanel({
																															store : new Ext.data.JsonStore({
																																autoDestroy : true,
																																autoLoad : true,
																																proxy : {
																																	type : 'ajax',
																																	url : SystemTool.basePath + '/scene.jhtml?method=queryAll',
																																	reader : {
																																		type : 'json',
																																		idProperty : 'id'
																																	}
																																},

																																fields : [ 'id', 'name' ]
																															}),
																															columns : [ {
																																xtype : 'gridcolumn',
																																header : "序号",
																																hideable : false,
																																width : 80,
																																dataIndex : 'id'
																															}, {
																																xtype : 'gridcolumn',
																																header : "名称",
																																sortable : true,
																																hideable : false,
																																width : 120,
																																dataIndex : 'name'
																															}, {
																																xtype : 'gridcolumn',
																																header : "删除",
																																sortable : true,
																																hideable : false,
																																width : 80,
																																renderer : delSceneRecord,
																																dataIndex : 'id'
																															}

																															],
																															id : "sceneGrid",
																															width : 280,
																															height : 220,
																															stripeRows : true,
																															autoScroll : true,
																															border : false
																														}) ]
																													}).show();
																													resetFunc();
																												}
																											}, {
																												text : '场景列表',
																												menu : sceneMenu
																											} ]
																								})
																					},
																					'-',
																					{
																						text : '飞行浏览',
																						menu : new Ext.menu.Menu(
																								{
																									// 设置菜单四条边都有阴影
																									// 添加菜单项
																									items : [
																											{
																												text : '创建飞行路线',
																												handler : function() {
																													resetFunc();
																													var createFlyRouteWindow = Ext.getCmp('createFlyRouteWindow');
																													if (createFlyRouteWindow == undefined) {
																														createFlyRouteWindow = new Ext.Window(
																																{
																																	id : 'createFlyRouteWindow',
																																	title : '创建飞行路线',
																																	width : 200,
																																	height : 70,
																																	y : 50,
																																	autoScroll : false,
																																	modal : false,
																																	closeAction : 'hide',
																																	resizable : false,
																																	plain : false,
																																	minButtonWidth : 60,
																																	layout : 'column',
																																	items : [
																																			{
																																				columnWidth : .33,
																																				layout : 'form',
																																				border : false,
																																				items : [ new Ext.Button({
																																					text : '开始',
																																					listeners : {
																																						click : function() {
																																							startDrawShape("Path");
																																						}
																																					}
																																				}) ]
																																			},
																																			{
																																				columnWidth : .33,
																																				layout : 'form',
																																				border : false,
																																				items : [ new Ext.Button({
																																					text : '暂停',
																																					listeners : {
																																						click : function() {
																																							// PeKong.form.flyroute.getRouteBuilder().setArmed(false);
																																							pauseQuery();
																																							this.setText(this.getText() == '暂停' ? '继续'
																																									: '暂停');
																																						}
																																					}
																																				}) ]
																																			},
																																			{
																																				columnWidth : .33,
																																				layout : 'form',
																																				border : false,
																																				items : [ new Ext.Button(
																																						{
																																							text : '结束',
																																							listeners : {
																																								click : function() {
																																									// PeKong.form.flyroute.unsetTool();
																																									// var
																																									// positions
																																									// =
																																									// PeKong.form.flyroute.getRouteBuilder().getPositions();
																																									// for(var
																																									// i=0;i<positions.size();i++)
																																									// {
																																									// var
																																									// pos
																																									// =
																																									// positions.get(i);
																																									// PeKong.form.flyroute.pts.push(new
																																									// XPoint(pos.getLongitude().getDegrees(),pos.getLatitude().getDegrees()));
																																									// }
																																									// PeKong.form.flyroute.getRouteBuilder().clear();
																																									// PeKong.form.flyroute.getInputWindow().show();

																																									new Ext.Window(
																																											{
																																												id : "createFlyRouteInput",
																																												title : '指定飞行路线名称',
																																												width : 300,
																																												height : 120,
																																												autoScroll : false,
																																												modal : false,
																																												closeAction : 'hide',
																																												resizable : false,
																																												plain : false,
																																												minButtonWidth : 50,
																																												items : [ new Ext.FormPanel(
																																														{
																																															labelAlign : 'left',
																																															bodyStyle : 'padding:5px',
																																															autoWidth : true,
																																															border : false,
																																															items : [ {
																																																xtype : 'textfield',
																																																fieldLabel : '飞行路线名称',
																																																id : 'flyRouteName_input',
																																																allowBlank : false
																																															} ],
																																															buttons : [
																																																	{
																																																		text : '提交',
																																																		listeners : {
																																																			click : function() {
																																																				var flyRouteName = Ext
																																																						.getCmp(
																																																								'flyRouteName_input')
																																																						.getValue();
																																																				// var
																																																				// flyRouteName=Ext.get('flyRouteName_input').dom.value;
																																																				var points = stopQueryTool();

																																																				Ext.Ajax
																																																						.request({
																																																							url : SystemTool.basePath
																																																									+ '/flyRoute.jhtml?method=add',
																																																							params : {
																																																								name : flyRouteName,
																																																								points : points,
																																																								length : getLength() / 1000
																																																							},
																																																							method : 'POST',
																																																							success : function(
																																																									response,
																																																									options) {
																																																								var responseJson = Ext.JSON
																																																										.decode(response.responseText);
																																																								Ext.Msg
																																																										.alert(
																																																												'系统提示',
																																																												responseJson.msg);
																																																								Ext
																																																										.getCmp(
																																																												'createFlyRouteInput')
																																																										.destroy();
																																																								loadFlyRouteMenu();
																																																							}
																																																						});
																																																			}
																																																		}
																																																	},
																																																	{
																																																		text : '取消',
																																																		listeners : {
																																																			click : function() {
																																																				clearQuery();
																																																				var points = stopQueryTool();
																																																				Ext
																																																						.getCmp(
																																																								'createFlyRouteInput')
																																																						.destroy();
																																																			}
																																																		}
																																																	} ]
																																														}) ]
																																											}).show();
																																								}
																																							}
																																						}) ]
																																			} ]
																																});
																													}
																													resetFunc();
																													createFlyRouteWindow.show();
																												}
																											}, {
																												text : '管理飞行路线',
																												handler : function() {
																													resetFunc();
																													new Ext.Window({
																														title : '管理飞行路线',
																														width : 300,
																														y : 130,
																														autoScroll : true,
																														modal : false,
																														closeAction : 'hide',
																														resizable : false,
																														plain : false,
																														minButtonWidth : 60,
																														layout : 'column',
																														items : [ new Ext.grid.GridPanel({
																															store : new Ext.data.JsonStore({
																																autoDestroy : true,
																																autoLoad : true,
																																proxy : {
																																	type : 'ajax',
																																	url : SystemTool.basePath + '/flyRoute.jhtml?method=queryAll',
																																	reader : {
																																		type : 'json',
																																		idProperty : 'id'
																																	}
																																},
																																fields : [ 'id', 'name' ]
																															}),
																															columns : [ {
																																xtype : 'gridcolumn',
																																header : "序号",
																																hideable : false,
																																width : 80,
																																dataIndex : 'id'
																															}, {
																																xtype : 'gridcolumn',
																																header : "名称",
																																sortable : true,
																																hideable : false,
																																width : 120,
																																dataIndex : 'name'
																															}, {
																																xtype : 'gridcolumn',
																																header : "删除",
																																sortable : true,
																																hideable : false,
																																width : 80,
																																renderer : delFlyRouteRecord,
																																dataIndex : 'id'
																															} ],
																															id : "flyRouteGrid",
																															width : 280,
																															height : 220,
																															stripeRows : true,
																															autoScroll : true,
																															border : false
																														}) ]
																													}).show();
																												}
																											}, {
																												text : '飞行路线列表',
																												menu : flyRouteMenu
																											} ]
																								})
																					}, '-', {
																						text : '清除',
																						iconCls : 'clear',
																						handler : function() {
																							resetFunc();
																							clearQuery();
																							theApplet.getMeasureToolOption().stopMeasure();
																							removeAllMarkers();// 标注的图层
																							removeAllAnnotation();// 小冒泡图层
																							removeAllKml();// KML文件加载的图层
																							removeAllShp();// shp文件加载的图层
																							removedAllShape();// 绘画的图层
																							// IndexTool.stopAllTool();//结束所有分析工具
																							// removeMouseClickListenerFunc();
																						}
																					}, '-',
																					/*
																					 * { text : '下载jdk', iconCls : 'load', handler : function(){ window.open("./lib/jre.exe",
																					 * "_blank"); } },'-',
																					 */
																					{
																						text : '复位',
																						iconCls : 'resetmap',
																						handler : function() {
																							resetFunc();
																							IndexTool.stopAllTool();
																							flyToLocation(41.3124, 122.4610, 0, 0, 0, 1418000);
																						}
																					}, {
																						text : '全屏/退出',
																						id : 'fullScreen',
																						iconCls : 'fullScreen',
																						handler : function() {
																							if (Ext.getCmp('west').collapsed) {
																								Ext.getCmp('north').show();
																								Ext.getCmp('west').toggleCollapse(false);
																								// document.getElementById("wwjApplet").style.height=(document.body.clientHeight-145)+"px";
																							} else {
																								Ext.getCmp('north').hide();
																								Ext.getCmp('west').toggleCollapse(true);
																								// document.getElementById("wwjApplet").style.height=(document.body.clientHeight-58)+"px";
																							}
																						}
																					},
																					// ,'-','欢迎
																					// '+userName+'用户，今天是'+currentime,'-',{
																					// text
																					// :
																					// '修改密码',
																					// id:'updatePwd',
																					// handler
																					// :
																					// function(){
																					// App.updatePwd();
																					// }
																					// },'-',
																					{
																						text : '退出系统',
																						id : 'logout',
																						handler : function() {
																							window.location = hostPath + "/logout.jhtml";
																						}
																					} ]
																		} ],
																		html : '<iframe id="wwjAppletIframe" style="display:block;position:absolute;background-color:transparent" name="wwjAppletIframe" width="100%" height="100%" frameborder="0" src="applet.jsp"></iframe>'
																	// html:'<div
																	// style="height:100%;width:100%;position:relative;background-color:green"><div
																	// style="height:100%;width:100%;position:absolute;z-index:1;background-color:blue;"><iframe
																	// id="wwjAppletIframe"
																	// name="wwjAppletIframe"
																	// width="100%"
																	// height="100%"
																	// frameborder="0"
																	// src="applet.jsp"></iframe></div><div
																	// style="height:60px;width:86px;position:absolute;background-color:red;bottom:10px;left:10px;z-index:2"/></div>'
																	// html :
																	// "<iframe
																	// id='wwjAppletIframe'
																	// name='wwjAppletIframe'
																	// width='100%'
																	// height='100%'
																	// frameborder='0'
																	// src='applet.jsp'></iframe>"
																	},
																	{
																		xtype : 'panel',
																		title : '二维视图',
																		name : 'tab2d',
																		layout : {
																			type : 'hbox',
																			align : 'stretch'
																		},
																		items : [
																				{
																					xtype : 'panel',
																					flex : 1,
																					// width
																					// :
																					// 500,
																					bodyBorder : false,
																					header : false,
																					title : '二维',
																					name : 'map2d',
																					dockedItems : [ {
																						xtype : 'toolbar',
																						dock : 'top',
																						height : 36,
																						items : [
																								// {
																								// xtype
																								// :
																								// 'button',
																								// text
																								// :
																								// '地形',
																								// width:100,
																								// style:
																								// {
																								// background:'#fff'
																								// },
																								// menu
																								// : {
																								// xtype
																								// :
																								// 'menu',
																								// width
																								// :
																								// 100,
																								// items
																								// : [
																								// {
																								// xtype
																								// :
																								// 'menuitem',
																								// text
																								// :
																								// '行政',
																								// name
																								// :
																								// 'xz',
																								// handler:function(){
																								// map.setBaseLayer(untiled);
																								// }
																								// },
																								// {
																								// xtype
																								// :
																								// 'menuitem',
																								// text
																								// :
																								// '影像',
																								// name
																								// :
																								// 'yx',
																								// handler:function(){
																								// map.setBaseLayer(untiled1);
																								// }
																								// },
																								// {
																								// xtype
																								// :
																								// 'menuitem',
																								// text
																								// :
																								// '地形',
																								// name
																								// :
																								// 'dx',
																								// handler:function(){
																								// map.setBaseLayer(untiled2);
																								// }
																								// } ]
																								// }
																								// },
																								{
																									text : '三维',
																									id : 'change3d',
																									handler : function() {
																										// <img
																										// class="hover"
																										// id="change2d"
																										// src="images/header/map.png"
																										// style="display:block;height:60px;width:86px;position:absolute;bottom:16px;left:10px;z-index:19002;float:left;"/>
																									}
																								},
																								{
																									xtype : 'tbfill'
																								},

																								{
																									xtype : 'button',
																									text : '定位',
																									width : 100,
																									style : {
																										background : '#fff'
																									},
																									menu : {
																										xtype : 'menu',
																										width : 100,
																										items : [
																												{
																													xtype : 'menuitem',
																													text : '小班定位',
																													name : 'xb',
																													handler : function() {

																														var xbPositionWindow = Ext.getCmp('xbPositionWindow');
																														if (xbPositionWindow == undefined) {
																															xbPositionWindow = new Ext.Window({
																																id : "xbPositionWindow",
																																title : '小班林班定位',
																																width : 350,
																																height : 200,
																																layout : 'fit',
																																autoScroll : false,
																																modal : false,
																																closeAction : 'hide',
																																resizable : false,
																																plain : false,
																																minButtonWidth : 50,
																																y : 100,
																																items : [ new Ext.FormPanel({
																																	labelAlign : 'left',
																																	bodyStyle : 'padding:5px',
																																	width : 280,
																																	height : 180,
																																	labelWidth : 50,
																																	border : false,
																																	items : [ {
																																		xtype : 'treepicker',
																																		fieldLabel : '行政区划',
																																		labelAlign : 'right',
																																		labelWidth : 80,
																																		anchor : '100%',
																																		margin : 10,
																																		name : 'unitID',
																																		displayField : 'text',
																																		valueField : 'value',
																																		rootVisible : true,
																																		minPickerHeight : 400,
																																		maxPickerHeight : 400,
																																		store : Ext.create('Ext.data.TreeStore', {
																																			fields : [ 'text', 'value', 'codelevel', 'code' ],
																																			root : {
																																				expanded : true,
																																				text : cur_areaName,// "辽宁省",
																																				id : cur_areaID,// '0021',
																																				leaf : false
																																			},
																																			proxy : {
																																				type : 'ajax',
																																				url : hostPath + '/j2UnitCode.jhtml?method=queryList',
																																				reader : {
																																					type : 'json'
																																				}
																																			}
																																		})
																																	}, {
																																		xtype : 'textfield',
																																		fieldLabel : '林班号',
																																		labelAlign : 'right',
																																		anchor : '100%',
																																		labelWidth : 80,
																																		id : 'positioner_linban',
																																		name : 'positioner_linban',
																																		allowBlank : true
																																	}, {
																																		xtype : 'textfield',
																																		fieldLabel : '小班号',
																																		anchor : '100%',
																																		labelAlign : 'right',
																																		labelWidth : 80,
																																		id : 'positioner_xiaoban',
																																		name : 'positioner_xiaoban',
																																		allowBlank : true
																																	} ],
																																	buttons : [ {
																																		text : '定位',
																																		listeners : {
																																			click : function() {
																																				var treepicker = xbPositionWindow.down('treepicker');// Ext.ComponentQuery.query('xblocationWidget
																																				// treepicker[name="unitID"]')[0];
																																				var cun = treepicker.displayTplData[0].code;
																																				var lbh = xbPositionWindow.down(
																																						'textfield[name="positioner_linban"]')
																																						.getValue();// Ext.getCmp('positioner_linban').getValue();//Ext.ComponentQuery.query('xblocationWidget
																																				// combobox[name="positioner_linban"]')[0].getValue();
																																				var xbh = xbPositionWindow.down(
																																						'textfield[name="positioner_xiaoban"]')
																																						.getValue();// Ext.getCmp('positioner_xiaoban').getValue()//Ext.ComponentQuery.query('xblocationWidget
																																				// combobox[name="positioner_xiaoban"]')[0].getValue();
																																				Ext.getCmp('xbPositionWindow').hide();
																																				// console.log(queryTool2D);
																																				locateXB(cun, lbh, xbh, function(req) {
																																					var gml = new OpenLayers.Format.GML();
																																					var features = gml.read(req.responseText);
																																					if (features == undefined || features.length < 1) {
																																						noXB();
																																						return;
																																					}

																																					// 定位
																																					queryResultLayer.drawFeature(features[0],
																																							styleMap["hightlight2"]);
																																					var center = features[0].geometry.getCentroid();
																																					map.setCenter(new OpenLayers.LonLat(center.x,
																																							center.y), 13);
																																					// map.zoomToExtent(features[0].geometry.bounds);
																																					// 选中高亮效果
																																					queryResultLayer.removeAllFeatures();
																																					queryResultLayer.addFeatures(features[0]);
																																				});
																																				// flyTo(lat,lon);
																																			}
																																		}
																																	} ]
																																}) ]
																															});
																														}
																														xbPositionWindow.show();
																														var me = xbPositionWindow.down('treepicker');
																														var record = Ext.getCmp('westTree').getSelectionModel().getSelection()[0];
																														if (record == undefined)
																															return;
																														me.displayTplData = [ record.data ];
																														me.setValue(record.get('value'));
																														me.setRawValue(record.get('text'));
																													}
																												},
																												{
																													xtype : 'menuitem',
																													text : '经纬度定位',
																													name : 'yx',
																													handler : function() {
																														var latlonPositionerWindow = Ext.getCmp('lonlatPositionWindow');
																														if (latlonPositionerWindow == undefined) {
																															latlonPositionerWindow = new Ext.Window({
																																id : "lonlatPositionWindow",
																																title : '经纬度定位',
																																width : 350,
																																height : 160,
																																layout : 'fit',
																																autoScroll : false,
																																modal : false,
																																closeAction : 'hide',
																																resizable : false,
																																plain : false,
																																minButtonWidth : 50,
																																items : [ new Ext.FormPanel({
																																	labelAlign : 'left',
																																	bodyStyle : 'padding:5px',
																																	labelWidth : 50,
																																	border : false,
																																	items : [ {
																																		xtype : 'numberfield',
																																		fieldLabel : '经度',
																																		anchor : '100%',
																																		id : 'latlonPositioner_lon',
																																		allowBlank : false,
																																		minValue : -180,
																																		maxValue : 180
																																	}, {
																																		xtype : 'numberfield',
																																		fieldLabel : '纬度',
																																		anchor : '100%',
																																		id : 'latlonPositioner_lat',
																																		allowBlank : false,
																																		minValue : -180,
																																		maxValue : 180
																																	} ],
																																	buttons : [ {
																																		text : '定位',
																																		listeners : {
																																			click : function() {
																																				var lon = parseFloat(Ext.getCmp('latlonPositioner_lon')
																																						.getValue());
																																				var lat = parseFloat(Ext.getCmp('latlonPositioner_lat')
																																						.getValue());
																																				Ext.getCmp('lonlatPositionWindow').hide();
																																				var pt = new OpenLayers.Geometry.Point(lon, lat);
																																				var bound = map.calculateBounds(pt,
																																						0.0000858306884765625);
																																				// map.zoomToExtent(bound);
																																				map.moveTo(new OpenLayers.LonLat(lon, lat), 9);

																																				pointLayer.clearMarkers();

																																				var size = new OpenLayers.Size(21, 25);
																																				var offset = new OpenLayers.Pixel(-(size.w / 2),
																																						-size.h);
																																				var icon = new OpenLayers.Icon(hostPath
																																						+ '/images/marker/3-grn-blank.png', size,
																																						offset);
																																				pointLayer.addMarker(new OpenLayers.Marker(
																																						new OpenLayers.LonLat(lon, lat)));
																																			}
																																		}
																																	} ]
																																}) ]
																															});
																														}
																														latlonPositionerWindow.show();
																													}
																												},
																												{
																													xtype : 'menuitem',
																													text : '高斯定位',
																													name : 'dx',
																													handler : function() {
																														// IndexTool.stopAllTool();
																														// startMeasureHeight();
																														var gaussPositionWindow = Ext.getCmp('gaussPositionWindow');
																														if (gaussPositionWindow == undefined) {
																															gaussPositionWindow = new Ext.Window(
																																	{
																																		id : 'gaussPositionWindow',
																																		title : '高斯坐标定位',
																																		width : 350,
																																		height : 180,
																																		// y:115,
																																		autoScroll : false,
																																		modal : false,
																																		closeAction : 'hide',
																																		resizable : false,
																																		layout : 'fit',
																																		plain : false,
																																		minButtonWidth : 60,
																																		items : [ new Ext.FormPanel(
																																				{
																																					labelAlign : 'left',
																																					bodyStyle : 'padding:5px',
																																					// width:330,
																																					// height:100,
																																					labelWidth : 40,
																																					border : false,
																																					// layout:'column',
																																					items : [ new Ext.form.ComboBox({
																																						id : 'gaussPositioner_fendai',
																																						fieldLabel : '分带',
																																						store : new Ext.data.SimpleStore({
																																							fields : [ 'display' ],
																																							data : [ [ '3度带' ], [ '6度带' ] ]
																																						}),
																																						displayField : 'display',
																																						valueField : 'display',
																																						mode : 'local',
																																						anchor : '100%',
																																						triggerAction : 'all',
																																						selectOnFocus : true,
																																						// width:100,
																																						emptyText : '请选择',
																																						listeners : {
																																							'select' : function() {

																																							}
																																						}
																																					}), {
																																						xtype : 'numberfield',
																																						fieldLabel : 'X坐标',
																																						anchor : '100%',
																																						// width:100,
																																						id : 'gaussPositioner_x',
																																						allowBlank : false
																																					}, {
																																						xtype : 'textfield',
																																						fieldLabel : '  ',
																																						anchor : '100%',
																																						// width:100,
																																						id : 'gaussPositioner_daihao',
																																						allowBlank : true,
																																						hidden : true
																																					}, {
																																						xtype : 'numberfield',
																																						fieldLabel : 'Y坐标',
																																						anchor : '100%',
																																						// width:100,
																																						id : 'gaussPositioner_y',
																																						allowBlank : false
																																					} ],
																																					buttons : [ {
																																						text : '定位',
																																						listeners : {
																																							click : function() {
																																								if ($('gaussPositioner_fendai').value == '请选择') {
																																									Ext.Msg.alert('系统提示', '请选择分带。');
																																									return;
																																								}

																																								var z = parseFloat(Ext.getCmp(
																																										'gaussPositioner_fendai')
																																										.getValue());
																																								var x = parseFloat(Ext.getCmp(
																																										'gaussPositioner_x').getValue());
																																								var y = parseFloat(Ext.getCmp(
																																										'gaussPositioner_y').getValue());

																																								// var
																																								// aa =
																																								// GaussToBL(x,y,z);
																																								// var
																																								// aa =
																																								// GaussToBL1(x,y,42);
																																								
																																								var temp = 0;
																																								if(z=="6"){
																																									temp = 1;
																																								}

																																							    var lonlat = GaussToBL2(x,y,temp);
																																							    //var re = GaussToBL2(4541057,40415864,0);
																																								//console.log(lonlat);
																																								pointLayer.addMarker(new OpenLayers.Marker(
																																										new OpenLayers.LonLat(
																																												lonlat.lon,
																																												lonlat.lat)));
																																								map.moveTo(
																																										new OpenLayers.LonLat(
																																												lonlat.lon,
																																												lonlat.lat),
																																										9);

//																																						pointLayer.clearMarkers();
//
//																																						var size = new OpenLayers.Size(21, 25);
//																																						var offset = new OpenLayers.Pixel(-(size.w / 2),-size.h);
//																																						var icon = new OpenLayers.Icon(
//																																								hostPath
//																																										+ '/images/marker/3-grn-blank.png',
//																																								size, offset);

//																																								Ext.Ajax
//																																										.request({
//																																											url : SystemTool.basePath
//																																													+ '/sysDic.jhtml?method=gaussToBL',
//																																											params : {
//																																												x : x,
//																																												y : y,
//																																												z : z
//																																											},
//																																											method : 'POST',
//																																											success : function(
//																																													response, options) {
//																																												var data = Ext.JSON
//																																														.decode(response.responseText);
//																																												Ext
//																																														.getCmp(
//																																																'gaussPositionWindow')
//																																														.hide();
//																																												map
//																																														.moveTo(
//																																																new OpenLayers.LonLat(
//																																																		data.x,
//																																																		data.y),
//																																																9);
//
//																																												pointLayer
//																																														.clearMarkers();
//
//																																												var size = new OpenLayers.Size(
//																																														21, 25);
//																																												var offset = new OpenLayers.Pixel(
//																																														-(size.w / 2),
//																																														-size.h);
//																																												var icon = new OpenLayers.Icon(
//																																														hostPath
//																																																+ '/images/marker/3-grn-blank.png',
//																																														size, offset);
//																																												pointLayer
//																																														.addMarker(new OpenLayers.Marker(
//																																																new OpenLayers.LonLat(
//																																																		data.x,
//																																																		data.y)));
//																																											},
//																																											failure : function(
//																																													response, options) {
//																																												Ext.MessageBox
//																																														.alert(
//																																																'失败',
//																																																'请求超时或网络故障,错误编号：'
//																																																		+ response.status);
//																																											}
//																																										});

																																								// console.log(aa);
																																								// var
																																								// type
																																								// = 0;
																																								// if($('gaussPositioner_fendai').value=='6度带')
																																								// {
																																								// type
																																								// = 1;
																																								// }
																																								// Ext.getCmp('gaussPositionWindow').hide();
																																								// var
																																								// pt =
																																								// GaussPrj.gaussToLatLonGauss(x,y,type);
																																								// pt =
																																								// [aa.long,aa.lat];
																																								// var
																																								// bound
																																								// =
																																								// map.calculateBounds(pt,
																																								// 0.0000858306884765625);
																																								// map.zoomToExtent(bound);

																																								// map.moveTo(new
																																								// OpenLayers.LonLat(aa.long,aa.lat),9);

																																								// pointLayer.clearMarkers();

																																								// var
																																								// size
																																								// =
																																								// new
																																								// OpenLayers.Size(21,25);
																																								// var
																																								// offset
																																								// =
																																								// new
																																								// OpenLayers.Pixel(-(size.w/2),
																																								// -size.h);
																																								// var
																																								// icon
																																								// =
																																								// new
																																								// OpenLayers.Icon(hostPath+'/images/marker/3-grn-blank.png',
																																								// size,
																																								// offset);
																																								// pointLayer.addMarker(new
																																								// OpenLayers.Marker(new
																																								// OpenLayers.LonLat(aa.long,aa.lat)));
																																							}
																																						}
																																					} ]
																																				}) ]
																																	});
																														}
																														gaussPositionWindow.show();
																													}
																												} ,{

																													text : '图幅定位',
																													iconCls : 'high',
																													handler : function() {
																														// IndexTool.stopAllTool();
																														// startMeasureHeight();
																														var picPositionWindow1 = Ext.getCmp('picPositionWindow1');
																														if (picPositionWindow1 == undefined) {
																															picPositionWindow1 = new Ext.Window({
																																id : 'picPositionWindow1',
																																// y:115,
																																autoScroll : false,
																																modal : false,
																																closeAction : 'hide',
																																 height: 152,
																																    width: 342,
																																    layout: 'fit',
																																    defaultButton: '',
																																    title: '图幅定位',
																																    items: [
																																        {
																																            xtype: 'tabpanel',
																																            activeTab: 0,
																																            items: [
																																                {
																																                    xtype: 'panel',
																																                    style: {
																																                        lineHeight: '30px'
																																                    },
																																                    title: '旧图幅号',
																																                    layout: {
																																                        type: 'hbox',
																																                        align: 'stretch'
																																                    },
																																                    items: [
																																                        {
																																                            xtype: 'textfield',
																																                            flex: 4,
																																                            fieldLabel: '',
																																                            labelSeparator: '',
																																                            fieldCls: '',
																																                            margin:'5,0,5,0'
																																                        },
																																                        {
																																                            xtype: 'container',
																																                            flex: 0,
																																                            html: '－',
																																                            style: {
																																                                lineHeight: '30px'
																																                            }
																																                        },
																																                        {
																																                            xtype: 'textfield',
																																                            flex: 4,
																																                            fieldLabel: '',
																																                            margin:'5,0,5,0'
																																                        },
																																                        {
																																                            xtype: 'container',
																																                            flex: 0,
																																                            html: '－',
																																                            style: {
																																                                lineHeight: '30px'
																																                            }
																																                        },
																																                        {
																																                            xtype: 'textfield',
																																                            flex: 4,
																																                            fieldLabel: '',
																																                            margin:'5,0,5,0'
																																                        },
																																                        {
																																                            xtype: 'container',
																																                            flex: 0,
																																                            html: '－(',
																																                            style: {
																																                                lineHeight: '30px'
																																                            }
																																                        },
																																                        {
																																                            xtype: 'textfield',
																																                            flex: 4,
																																                            fieldLabel: '',
																																                            margin:'5,0,5,0'
																																                        },
																																                        {
																																                            xtype: 'container',
																																                            flex: 1,
																																                            html: ')'
																																                        }
																																                    ]
																																                },
																																                {
																																                    xtype: 'panel',
																																                    style: {
																																                        lineHeight: '30px'
																																                    },
																																                    title: '新图幅号',
																																                    layout: {
																																                        type: 'hbox',
																																                        align: 'stretch'
																																                    },
																																                    items: [
																																                        {
																																                            xtype: 'textfield',
																																                            flex: 4,
																																                            fieldLabel: '',
																																                            margin:'5,0,5,0'
																																                        }
																																                    ]
																																                }
																																            ]
																																        }
																																    ],
																																    dockedItems: [
																																        {
																																            xtype: 'toolbar',
																																            dock: 'bottom',
																																            layout: {
																																                type: 'hbox',
																																                align: 'middle',
																																                pack: 'end'
																																            },
																																            items: [
																																                {
																																                    xtype: 'button',
																																                    text: '定位',
																																                    handler:function(){
																																                    	if(picPositionWindow1.down('tabpanel').getActiveTab().title=="旧图幅号"){
																																                    		  var textFields  = picPositionWindow1.query("panel[title='旧图幅号'] textfield");
																																                    		  var arg1 = parseInt(textFields[0].getValue());
																																                    		  var arg2 = parseInt(textFields[1].getValue());
																																                    		  var arg3 = parseInt(textFields[2].getValue());
																																                    		  var arg4 = parseInt(textFields[3].getValue());

																																                    		  var bounds = getBounds(arg1,arg2,arg3,arg4);
																																                    		  map.zoomToExtent(bounds);
																																                    		  queryResultLayer.addFeatures(new OpenLayers.Feature.Vector(bounds.toGeometry()));

																																                    		}else{
																																                    		  var textFields  = picPositionWindow1.query("panel[title='新图幅号'] textfield");
																																                    		  var data = textFields[0].getValue();
																																                    		  var arg1 = data.substring(0,1);
																																                    		  var arg2 = parseInt(data.substring(1,3));
																																                    		  var arg3 = parseInt(data.substring(8,11));
																																                    		  var arg4 = parseInt(data.substring(4,7));

																																                    		  var bounds = getBounds(arg1,arg2,arg3,arg4);
																																                    		  map.zoomToExtent(bounds);
																																                    		  queryResultLayer.addFeatures(new OpenLayers.Feature.Vector(bounds.toGeometry()));
																																                    		}

																																                    }
																																                }
																																            ]
																																        }
																																    ]
																															});
																														}
																														picPositionWindow1.show();
																													}
																												
																												}]
																									}
																								},
																								{
																									xtype : 'combobox',
																									width : 100,
																									id : 'scaleCbx1',
																									// fieldLabel:
																									// '比例尺',
																									labelAlign : 'right',
																									// labelWidth:
																									// 40,
																									valueField : 'scale',
																									displayField : 'scale',
																									autoSelect : false,
																									queryMode : 'local',
																									store : new Ext.data.SimpleStore({
																										data : [ [ 3000000 ], [ 2000000 ], [ 1000000 ], [ 500000 ], [ 200000 ], [ 100000 ], [ 50000 ],
																												[ 20000 ], [ 10000 ], [ 5000 ], [ 2000 ], [ 1000 ] ],
																										fields : [ 'scale' ]
																									}),
																									listeners : {
																										select : function(me, e) {
																											setZoom1(me.getRawValue(), 1000);

																										},
																										specialkey : function(me, e) {
																											// e.HOME,
																											// e.END,
																											// e.PAGE_UP,
																											// e.PAGE_DOWN,
																											// e.TAB,
																											// e.ESC,
																											// arrow
																											// keys:
																											// e.LEFT,
																											// e.RIGHT,
																											// e.UP,
																											// e.DOWN
																											if (e.getKey() == e.ENTER) {
																												// console.log(me.getRawValue());
																												setZoom1(me.getRawValue(), 1000);
																											}
																										}
																									}
																								}, {
																									xtype : 'button',
																									text : '放大',
																									name : 'zoomIn2d',
																									handler : function() {
																										zoomin2D();
																									}
																								}, {
																									xtype : 'button',
																									text : '缩小',
																									name : 'zoomOut2d',
																									handler : function() {
																										clearActivate();
																										zoomout2D();
																									}
																								}, {
																									xtype : 'button',
																									text : '平移',
																									name : 'zoomPan2d',
																									handler : function() {
																										closezoom();
																										clearActivate();
																									}
																								},

																								{
																									xtype : 'button',
																									text : '测量 ',
																									menu : new Ext.menu.Menu({
																										// 设置菜单四条边都有阴影
																										shadow : 'frame',
																										// 添加菜单项
																										items : [ {
																											text : '测距离 ',
																											iconCls : 'measure',
																											handler : function() {
																												closezoom();
																												clearMeasure();
																												startMeasureDistance2D();
																											}
																										}, {
																											text : '测面积 ',
																											iconCls : 'area',
																											handler : function() {
																												closezoom();
																												clearMeasure();
																												startMeasureArea2D();
																											}
																										} ]
																									})
																								}, {
																									text : '清除',
																									iconCls : 'clear',
																									handler : function() {
																										closezoom();
																										clearActivate();
																										clearLastResult();
																										clearPopup();
																										// 清除专题图图层
																										// clearThematicMapLayer();
																										// 清除测量图层
																										clearMeasure();
																										pointLayer.clearMarkers();
																									}
																								}, {
																									xtype : 'button',
																									text : '小班查询',
																									menu : new Ext.menu.Menu({
																										// 设置菜单四条边都有阴影
																										shadow : 'frame',
																										// 添加菜单项
																										items : [ {
																											text : '点选 查询',
																											iconCls : 'selectByPnt',
																											handler : function() {
																												selectByPnt();
																												closezoom();
																											}
																										}, {
																											text : '多边形查询',
																											handler : function() {
																												toggleControl('selectByPolygon');
																												// map.controls[10].activate();
																											}
																										} ]
																									})
																								}, {
																									text : '行政区查询',
																									menu : new Ext.menu.Menu({
																										// 设置菜单四条边都有阴影
																										shadow : 'frame',
																										// 添加菜单项
																										items : [ {
																											text : '县(区)级查询',
																											handler : function() {
																												selectLayer = 'xian';
																												toggleControl('staticsByPnt');
																											}
																										}, {
																											text : '乡(场)级查询',
																											handler : function() {
																												selectLayer = 'xiang';
																												toggleControl('staticsByPnt');
																											}
																										}, {
																											text : '村级查询',
																											handler : function() {
																												selectLayer = 'cun';
																												toggleControl('staticsByPnt');
																											}
																										} ]
																									}),
																									iconCls : 'selectByPnt',
																									handler : function() {
																										toggleControl('staticsByPnt');
																									}
																								}, {
																									xtype : 'button',
																									text : '复位',
																									name : 'zoomFullExtent2d',
																									handler : function() {
																										closezoom();
																										zoomToExtent();
																									}
																								}, {
																									text : '全屏/退出',
																									iconCls : 'fullScreen',
																									handler : function() {
																										if (Ext.getCmp('west').collapsed) {
																											Ext.getCmp('north').show();
																											Ext.getCmp('west').toggleCollapse(false);
																											// document.getElementById("wwjApplet").style.height=(document.body.clientHeight-145)+"px";
																										} else {
																											Ext.getCmp('north').hide();
																											Ext.getCmp('west').toggleCollapse(true);
																											// document.getElementById("wwjApplet").style.height=(document.body.clientHeight-58)+"px";
																										}
																									}
																								},
																								// {
																								// xtype
																								// :
																								// 'combobox',
																								// width
																								// :
																								// 86,
																								// fieldLabel
																								// :
																								// 'Label',
																								// hideLabel
																								// :
																								// true,
																								// emptyText
																								// :
																								// '小班年度',
																								// name
																								// :
																								// 'xbYear',
																								// fieldLabel:'年度',
																								// name:'fieldName',
																								// store:new
																								// Ext.data.ArrayStore({
																								// fields:
																								// ['year','year'],
																								// data:
																								// [['2012',
																								// '2012'],['2013',
																								// '2013'],['2014','2014'],['2015','2015']]
																								// }),
																								// value:'2012',
																								// valueField:
																								// 'year',
																								// displayField:
																								// 'year',
																								// listeners:{
																								// select
																								// :
																								// function(_combo,records,eOpts)
																								// {
																								// var
																								// year
																								// =
																								// _combo.getValue();
																								// switchXB(1,year);
																								// }
																								// }
																								// },
																								'-', {
																									text : '退出系统',
																									id : 'logout1',
																									handler : function() {
																										window.location = hostPath + "/logout.jhtml";
																									}
																								} ]
																					} ],
																					html : '<div style="height:100%;width:100%;position:relative;"><div id="mask" style="overflow:hide;height:100%;width:100%;"><div id="zbar" style="position:absolute;left:3%;top:5%;z-index:500"></div><div id="oview" style="position:absolute;right:0%;top:60%;z-index:500"></div><div id="switcher" style="position:absolute;right:20%;top:20%;z-index:500"></div><div id="2dMap" style="height:150%;width:150%;position:absolute;z-index:1;top:-25%;left:-25%"></div><div id="scale11" style="position:absolute;right:0%;bottom:10%;z-index:500"></div><div id="mpst" style="position:absolute;right:0%;bottom:5%;z-index:500"></div></div>' // html
																				// :
																				// '<div
																				// style="height:100%;
																				// width:100%"
																				// id="2dMap"></div>'
																				}, {
																					xtype : 'panel',
																					collapsed : false,
																					collapsible : false,
																					header : false,
																					name : 'map2d1',
																					title : '二维1',
																					dockedItems : [ {
																						xtype : 'toolbar',
																						dock : 'top',
																						height : 36,
																						items : [ {
																							xtype : 'button',
																							text : '地形',
																							menu : {
																								xtype : 'menu',
																								width : 120,
																								items : [ {
																									xtype : 'menuitem',
																									text : '影像',
																									name : 'yx1',
																									handler : function() {
																										if (map1.getLayersByName("影像")[0])
																											map1.getLayersByName("影像")[0].setVisibility(true);
																										if (map1.getLayersByName("地形图")[0])
																											map1.getLayersByName("地形图")[0].setVisibility(false);
																									}
																								}, {
																									xtype : 'menuitem',
																									text : '地形',
																									name : 'dx1',
																									handler : function() {
																										if (map1.getLayersByName("影像")[0])
																											map1.getLayersByName("影像")[0].setVisibility(false);
																										if (map1.getLayersByName("地形图")[0])
																											map1.getLayersByName("地形图")[0].setVisibility(true);
																									}
																								} ]
																							}
																						}, {
																							xtype : 'tbfill'
																						}, {
																							xtype : 'button',
																							text : '查询',
																							name : 'xbIdentify1'
																						}, {
																							xtype : 'combobox',
																							width : 86,
																							fieldLabel : 'Label',
																							hideLabel : true,
																							emptyText : '小班年度',
																							name : 'xbYear1',
																							store : new Ext.data.ArrayStore({
																								fields : [ 'year', 'year' ],
																								data : [ [ '2012', '2012' ], [ '2013', '2013' ], [ '2014', '2014' ], [ '2015', '2015' ] ]
																							}),
																							value : '2013',
																							valueField : 'year',
																							displayField : 'year',
																							listeners : {
																								select : function(_combo, records, eOpts) {
																									var year = _combo.getValue();
																									switchXB(2, year);
																								}
																							}
																						} ]
																					} ],
																					html : '<div style="height:100%; width:100%" id="2dMap1"></div>'
																				} ]
																	} ]
														}

														],
													// html:'<div
													// style="height:100%;width:100%;position:relative;background-color:green"><div
													// id="tabContent"
													// style="height:100%;width:100%;position:absolute;z-index:1;background-color:blue;"/><div
													// style="height:100px;width:100px;position:absolute;background-color:red;bottom:20px;left:20px;z-index:2"/></div>'
													}, {
														xtype : 'toolbar',
														region : 'south',
														name : 'bottom',
														height : 30
													} ]
										});

						me.callParent(arguments);
					}

				});